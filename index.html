<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HydroBuddy Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Using system fonts to make the app lighter and offline-friendly */
        body { 
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #dbeafe 100%);
            color: #0369a1;
            transition: background-color 0.5s, color 0.5s; 
            min-height: 100vh;
        }

        .dark body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: #bae6fd;
        }

        .glass-card { 
            background: rgba(255, 255, 255, 0.25); 
            backdrop-filter: blur(20px) saturate(180%); 
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.4); 
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
            transition: all 0.3s ease;
        }

        .dark .glass-card { 
            background: rgba(255, 255, 255, 0.05); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        .progress-ring-circle { 
            transition: stroke-dashoffset 0.6s cubic-bezier(0.4, 0, 0.2, 1); 
            transform: rotate(-90deg); 
            transform-origin: 50% 50%; 
            filter: drop-shadow(0 0 8px rgba(56, 189, 248, 0.5));
        }
        
        .hourglass-top { clip-path: polygon(0% 0%, 100% 0%, 50% 100%); transition: transform 1s linear; }
        .hourglass-bottom { clip-path: polygon(50% 0%, 0% 100%, 100% 100%); }
        .sand-stream { width: 2px; background: #38bdf8; height: 0; position: absolute; left: 50%; transform: translateX(-50%); top: 50%; transition: height 0.5s; }
        .sand-stream.active { height: 50%; }

        /* Lighter wave implementation using inline SVG pattern */
        .wave-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            z-index: -1;
            opacity: 0.15;
            pointer-events: none;
        }
        
        .notification-toast { transform: translateY(100px); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 100; opacity: 0; }
        .notification-toast.show { transform: translateY(0); opacity: 1; }

        .history-bar { transition: height 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
        
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .btn-frost {
            background: rgba(255, 255, 255, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.2s;
        }
        .btn-frost:hover { background: rgba(255, 255, 255, 0.6); }
        .dark .btn-frost {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        .dark .btn-frost:hover { background: rgba(255, 255, 255, 0.15); }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 pb-20">

    <!-- Toast Notification -->
    <div id="toast" class="notification-toast fixed bottom-8 left-4 right-4 md:left-auto md:right-8 md:w-80 glass-card p-4 rounded-2xl shadow-xl flex items-center gap-4 pointer-events-none">
        <div class="bg-sky-500 p-2 rounded-full text-white animate-pulse">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
        </div>
        <div>
            <p id="toastTitle" class="font-bold text-sm">Notification</p>
            <p id="toastMessage" class="text-xs opacity-80 font-medium">Message goes here.</p>
        </div>
    </div>

    <main class="w-full max-w-md mt-2 space-y-6">
        <!-- Top Bar -->
        <header class="flex justify-between items-center px-2">
            <div>
                <h1 class="text-3xl font-extrabold text-sky-600 dark:text-sky-400 tracking-tight">HydroBuddy</h1>
                <p class="text-sky-400 text-xs font-semibold uppercase tracking-widest">Drink, Track, Glow</p>
            </div>
            <div class="flex gap-2">
                <button onclick="toggleTheme()" class="glass-card p-2.5 rounded-xl shadow-sm hover:scale-110 active:scale-95 transition-all">
                    <span id="themeIcon">üåô</span>
                </button>
            </div>
        </header>

        <!-- Streaks & Quick Stats -->
        <div class="grid grid-cols-2 gap-3">
            <div class="glass-card p-4 rounded-2xl flex items-center gap-3">
                <div class="bg-blue-100/50 dark:bg-blue-900/20 p-2 rounded-lg text-xl">‚ùÑÔ∏è</div>
                <div>
                    <p class="text-[10px] uppercase font-bold text-sky-500/60">Streak</p>
                    <p id="streakCount" class="text-xl font-bold">0 Days</p>
                </div>
            </div>
            <div class="glass-card p-4 rounded-2xl flex items-center gap-3">
                <div class="bg-sky-100/50 dark:bg-sky-900/20 p-2 rounded-lg text-xl">üèîÔ∏è</div>
                <div>
                    <p class="text-[10px] uppercase font-bold text-sky-500/60">Best</p>
                    <p id="bestStreak" class="text-xl font-bold">0 Days</p>
                </div>
            </div>
        </div>

        <!-- Main Progress -->
        <div class="glass-card rounded-3xl p-8 shadow-md flex flex-col items-center space-y-6 relative overflow-hidden">
            <div class="relative">
                <svg class="w-48 h-48">
                    <circle class="text-white/20 dark:text-white/5" stroke-width="12" stroke="currentColor" fill="transparent" r="85" cx="96" cy="96" />
                    <circle id="progressCircle" class="text-sky-400 progress-ring-circle" stroke-width="12" stroke-dasharray="534" stroke-dashoffset="534" stroke-linecap="round" stroke="currentColor" fill="transparent" r="85" cx="96" cy="96" />
                </svg>
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center">
                    <span id="currentAmount" class="text-4xl font-bold">0</span>
                    <span class="text-sky-500/60 text-xs block font-bold uppercase tracking-tighter">of <span id="goalLabel">2000</span>ml</span>
                </div>
            </div>

            <!-- Hourglass Timer -->
            <div id="timerContainer" class="hidden flex flex-col items-center space-y-3 w-full border-t border-white/20 dark:border-white/5 pt-6">
                <div class="relative w-12 h-20 border-2 border-sky-200 dark:border-sky-800 rounded-lg p-1 bg-white/10">
                    <div class="hourglass-top absolute top-1 left-1 right-1 h-[34px] bg-sky-100/20 overflow-hidden">
                        <div id="topSand" class="absolute inset-0 bg-sky-400 origin-bottom transition-transform duration-1000" style="transform: scaleY(1);"></div>
                    </div>
                    <div id="sandStream" class="sand-stream"></div>
                    <div class="hourglass-bottom absolute bottom-1 left-1 right-1 h-[34px] bg-sky-100/20 overflow-hidden">
                        <div id="bottomSand" class="absolute inset-0 bg-sky-400 origin-bottom transition-transform duration-1000" style="transform: scaleY(0);"></div>
                    </div>
                </div>
                <div class="text-center">
                    <p id="countdownDisplay" class="text-2xl font-mono font-bold text-sky-600 dark:text-sky-400 tracking-tighter">00:00</p>
                </div>
            </div>
        </div>

        <!-- Water Controls -->
        <div class="space-y-4">
            <div class="grid grid-cols-2 gap-4">
                <button onclick="addWater(50)" class="glass-card btn-frost p-5 rounded-2xl flex flex-col items-center active:scale-90 shadow-sm">
                    <span class="text-2xl mb-1">üíß</span>
                    <span class="font-bold text-sm">+50ml</span>
                </button>
                <button onclick="addWater(250)" class="glass-card btn-frost p-5 rounded-2xl flex flex-col items-center active:scale-90 shadow-sm">
                    <span class="text-2xl mb-1">üç∂</span>
                    <span class="font-bold text-sm">+250ml</span>
                </button>
            </div>
            
            <!-- Custom Water Intake -->
            <div class="glass-card p-3 rounded-2xl flex gap-2 items-center shadow-sm">
                <div class="flex-1 relative">
                    <input 
                        type="number" 
                        id="customWaterInput" 
                        placeholder="Log Custom Amount" 
                        class="w-full bg-transparent border-none py-2 px-4 text-sm font-bold placeholder:text-sky-300 focus:outline-none focus:text-sky-600 dark:focus:text-sky-300"
                    >
                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-[10px] font-bold text-sky-400/50">ML</span>
                </div>
                <button onclick="handleCustomWater()" class="bg-sky-500 hover:bg-sky-600 text-white px-6 py-2 rounded-xl text-xs font-bold transition-all active:scale-95 shadow-lg shadow-sky-500/20">
                    ADD
                </button>
            </div>
        </div>

        <!-- Settings -->
        <div class="glass-card rounded-2xl p-6 shadow-sm space-y-5">
            <div class="flex items-center justify-between">
                <div>
                    <h3 class="font-bold">Show Hourglass</h3>
                    <p id="timerInfo" class="text-[10px] text-sky-500 font-bold uppercase">Nudging every 60m</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="reminderToggle" class="sr-only peer" onchange="toggleReminders()">
                    <div class="w-11 h-6 bg-sky-200/50 dark:bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-sky-500"></div>
                </label>
            </div>

            <div class="space-y-2">
                <p class="text-[10px] text-sky-400 font-bold uppercase tracking-widest">Nudge Interval (Minutes)</p>
                <div class="flex flex-wrap gap-2">
                    <button id="int2" onclick="setIntervalMinutes(2)" class="flex-1 min-w-[50px] py-2 rounded-lg text-[10px] font-bold border btn-frost">2M</button>
                    <button id="int30" onclick="setIntervalMinutes(30)" class="flex-1 min-w-[50px] py-2 rounded-lg text-[10px] font-bold border btn-frost">30M</button>
                    <button id="int60" onclick="setIntervalMinutes(60)" class="flex-1 min-w-[50px] py-2 rounded-lg text-[10px] font-bold border btn-frost">1H</button>
                    
                    <div class="flex-[2] min-w-[100px] relative">
                        <input 
                            type="number" 
                            id="customIntervalInput" 
                            placeholder="Custom" 
                            class="w-full h-full py-2 px-3 rounded-lg text-[10px] font-bold border bg-white/10 text-sky-600 border-white/20 dark:border-white/5 focus:border-sky-500 focus:outline-none transition-all"
                            oninput="handleCustomInterval(this.value)"
                        >
                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-[8px] font-bold text-sky-400 pointer-events-none">MIN</span>
                    </div>
                </div>
            </div>

            <!-- Goal Slider -->
            <div class="space-y-2">
                <div class="flex justify-between items-center">
                    <label class="text-sm font-bold">Daily Goal</label>
                    <span class="text-xs text-sky-600 dark:text-sky-400 font-mono" id="goalVal">2000ml</span>
                </div>
                <input type="range" id="goalInput" min="1000" max="5000" step="100" value="2000" class="w-full h-1.5 bg-white/30 dark:bg-white/5 rounded-lg appearance-none cursor-pointer accent-sky-500" oninput="updateGoal()">
            </div>
            
            <div class="p-3 bg-white/30 dark:bg-white/5 rounded-xl border border-white/20 dark:border-white/5 flex justify-between items-center text-xs">
                <span class="opacity-70 font-semibold">Notifications:</span>
                <span id="permBadge" class="px-2 py-0.5 rounded text-[10px] font-bold bg-sky-100 dark:bg-slate-800 text-sky-600 uppercase">Unknown</span>
            </div>

            <button onclick="resetApp()" class="w-full py-2 text-[10px] font-bold text-red-400/70 hover:text-red-500 transition-colors uppercase tracking-widest">Wipe App Data</button>
        </div>

        <!-- History Chart (Bottom) -->
        <div class="glass-card rounded-2xl p-5 shadow-sm opacity-60 hover:opacity-100 transition-opacity">
            <h3 class="font-bold text-sm mb-4 flex items-center gap-2">
                <span>üìä</span> 7-Day History
            </h3>
            <div id="historyChart" class="flex items-end justify-between h-24 gap-1 px-1">
                <!-- Bars generated by JS -->
            </div>
            <div id="chartLabels" class="flex justify-between mt-2 px-1 text-[9px] font-bold text-sky-400/50 uppercase">
                <!-- Labels generated by JS -->
            </div>
        </div>
    </main>

    <!-- Inline SVG for Background wave -->
    <div class="wave-container">
        <svg viewBox="0 0 120 28" preserveAspectRatio="none" style="width:100%; height:100%; display:block;">
            <defs>
                <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
            </defs>
            <g class="parallax">
                <use xlink:href="#gentle-wave" x="48" y="0" fill="rgba(56, 189, 248, 0.3)" />
                <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(56, 189, 248, 0.5)" />
                <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(56, 189, 248, 0.2)" />
            </g>
        </svg>
    </div>

    <script>
        // State
        let state = {
            currentIntake: 0,
            dailyGoal: 2000,
            intervalMinutes: 60,
            remindersActive: false,
            darkMode: false,
            streak: 0,
            bestStreak: 0,
            lastHitDate: null,
            history: [],
            lastResetDate: new Date().toLocaleDateString()
        };

        let timerInterval = null;
        let secondsLeft = 0;
        const CIRCUM = 534;
        let audioCtx = null;

        // Element references
        const progressCircle = document.getElementById('progressCircle');
        const permBadge = document.getElementById('permBadge');
        const customIntervalInput = document.getElementById('customIntervalInput');
        const customWaterInput = document.getElementById('customWaterInput');

        // Audio Synthesis (Standalone friendly)
        function playBloop() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(400, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }

        function loadState() {
            const saved = localStorage.getItem('hydrobuddy_frost_state');
            if (saved) {
                const parsed = JSON.parse(saved);
                const todayStr = new Date().toLocaleDateString();
                
                if (parsed.lastResetDate !== todayStr) {
                    updateHistory(parsed.lastResetDate, parsed.currentIntake);
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    const yesterdayStr = yesterday.toLocaleDateString();

                    if (parsed.lastHitDate !== yesterdayStr && parsed.lastHitDate !== todayStr) {
                        parsed.streak = 0;
                    }
                    parsed.currentIntake = 0;
                    parsed.lastResetDate = todayStr;
                }
                state = { ...state, ...parsed };
            }
            applyTheme();
            updateUI();
            renderHistory();
            if (state.remindersActive) startCountdown();
        }

        function saveState() {
            localStorage.setItem('hydrobuddy_frost_state', JSON.stringify(state));
        }

        function updateUI() {
            document.getElementById('currentAmount').innerText = state.currentIntake;
            document.getElementById('goalLabel').innerText = state.dailyGoal;
            document.getElementById('goalVal').innerText = state.dailyGoal + "ml";
            document.getElementById('streakCount').innerText = `${state.streak} Days`;
            document.getElementById('bestStreak').innerText = `${state.bestStreak} Days`;
            document.getElementById('reminderToggle').checked = state.remindersActive;
            document.getElementById('goalInput').value = state.dailyGoal;
            document.getElementById('timerInfo').innerText = `Nudging every ${state.intervalMinutes}m`;
            
            const pct = Math.min(state.currentIntake / state.dailyGoal, 1);
            if (progressCircle) progressCircle.style.strokeDashoffset = CIRCUM - (pct * CIRCUM);

            const presets = [2, 30, 60];
            presets.forEach(m => {
                const btn = document.getElementById(`int${m}`);
                if (btn) {
                    if (state.intervalMinutes === m) {
                        btn.className = "flex-1 min-w-[50px] py-2 rounded-lg text-[10px] font-bold border bg-sky-500 text-white border-sky-400 shadow-lg shadow-sky-500/30";
                    } else {
                        btn.className = "flex-1 min-w-[50px] py-2 rounded-lg text-[10px] font-bold border btn-frost text-sky-400";
                    }
                }
            });

            if (!presets.includes(state.intervalMinutes)) {
                customIntervalInput.value = state.intervalMinutes;
                customIntervalInput.classList.add('border-sky-500', 'text-sky-600');
            } else {
                customIntervalInput.value = '';
                customIntervalInput.classList.remove('border-sky-500', 'text-sky-600');
            }

            checkPermission();
        }

        function updateHistory(dateStr, amount) {
            const shortDate = new Date(dateStr).toLocaleDateString([], { month: 'short', day: 'numeric' });
            state.history.push({ date: shortDate, amount: amount });
            if (state.history.length > 7) state.history.shift();
        }

        function renderHistory() {
            const chart = document.getElementById('historyChart');
            const labels = document.getElementById('chartLabels');
            if (!chart || !labels) return;
            chart.innerHTML = '';
            labels.innerHTML = '';

            let displayData = [...state.history];
            while (displayData.length < 7) {
                displayData.unshift({ date: '-', amount: 0 });
            }

            displayData.forEach(item => {
                const heightPct = Math.min((item.amount / state.dailyGoal) * 100, 100);
                const bar = document.createElement('div');
                bar.className = `history-bar flex-1 bg-sky-500/20 rounded-t-lg relative group overflow-hidden`;
                bar.innerHTML = `
                    <div class="absolute bottom-0 w-full bg-sky-400/60 rounded-t-lg transition-all duration-1000" style="height: ${heightPct}%"></div>
                    <div class="opacity-0 group-hover:opacity-100 absolute -top-8 left-1/2 -translate-x-1/2 bg-sky-900 text-white text-[8px] py-1 px-2 rounded-full pointer-events-none z-10 font-bold">${item.amount}ml</div>
                `;
                chart.appendChild(bar);

                const label = document.createElement('span');
                label.innerText = item.date;
                labels.appendChild(label);
            });
        }

        function addWater(amount) {
            playBloop();
            state.currentIntake += parseInt(amount);
            
            const todayStr = new Date().toLocaleDateString();
            if (state.currentIntake >= state.dailyGoal && state.lastHitDate !== todayStr) {
                state.lastHitDate = todayStr;
                state.streak++;
                if (state.streak > state.bestStreak) state.bestStreak = state.streak;
                sendNotification("Goal Reached! üî•", `You reached the peak! ${state.streak} day streak.`);
            }

            updateUI();
            saveState();
            renderHistory();
            showToast("Logged!", `Added ${amount}ml`);
        }

        function handleCustomWater() {
            const amount = parseInt(customWaterInput.value);
            if (!isNaN(amount) && amount > 0) {
                addWater(amount);
                customWaterInput.value = '';
            } else {
                showToast("Invalid Amount", "Please enter a valid amount.");
            }
        }

        function toggleTheme() {
            state.darkMode = !state.darkMode;
            applyTheme();
            saveState();
        }

        function applyTheme() {
            if (state.darkMode) {
                document.documentElement.classList.add('dark');
                document.getElementById('themeIcon').innerText = '‚òÄÔ∏è';
            } else {
                document.documentElement.classList.remove('dark');
                document.getElementById('themeIcon').innerText = 'üåô';
            }
        }

        function toggleReminders() {
            state.remindersActive = document.getElementById('reminderToggle').checked;
            saveState();
            const container = document.getElementById('timerContainer');
            if (state.remindersActive) {
                forceRequest();
                if (container) container.classList.remove('hidden');
                startCountdown();
            } else {
                clearInterval(timerInterval);
                if (container) container.classList.add('hidden');
            }
        }

        function setIntervalMinutes(mins) {
            const val = parseInt(mins);
            if (isNaN(val) || val < 1) return;
            state.intervalMinutes = val;
            updateUI();
            saveState();
            if (state.remindersActive) {
                startCountdown();
                showToast("Interval Set", `Nudging every ${val}m.`);
            }
        }

        function handleCustomInterval(val) {
            if (val && val > 0) setIntervalMinutes(val);
        }

        function startCountdown() {
            clearInterval(timerInterval);
            const interval = state.intervalMinutes * 60;
            secondsLeft = interval;
            
            timerInterval = setInterval(() => {
                secondsLeft--;
                const mins = Math.floor(secondsLeft / 60);
                const secs = secondsLeft % 60;
                const display = document.getElementById('countdownDisplay');
                if (display) display.innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                const ratio = secondsLeft / interval;
                const topS = document.getElementById('topSand');
                const botS = document.getElementById('bottomSand');
                const stream = document.getElementById('sandStream');
                
                if (topS) topS.style.transform = `scaleY(${ratio})`;
                if (botS) botS.style.transform = `scaleY(${1 - ratio})`;
                if (stream) stream.className = (secondsLeft > 0) ? 'sand-stream active' : 'sand-stream';

                if (secondsLeft <= 0) {
                    sendNotification("Stay Refreshed! ‚ùÑÔ∏è", "Time for some cold water.");
                    secondsLeft = interval;
                }
            }, 1000);
        }

        function checkPermission() {
            if (!permBadge) return;
            if (!("Notification" in window)) {
                permBadge.innerText = "N/A";
                return;
            }
            permBadge.innerText = Notification.permission.toUpperCase();
        }

        async function forceRequest() {
            if ("Notification" in window) {
                try {
                    await Notification.requestPermission();
                } catch(e) {
                    console.error("Permission request failed", e);
                }
            }
            checkPermission();
        }

        function sendNotification(title, body) {
            if (window.Notification && Notification.permission === "granted") {
                new Notification(title, { 
                    body, 
                    icon: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2338bdf8'%3E%3Cpath d='M12 21.5c-4.4 0-8-3.6-8-8 0-4.4 8-12 8-12s 8 7.6 8 12c0 4.4-3.6 8-8 8z'/%3E%3C/svg%3E" 
                });
            }
            showToast(title, body);
        }

        function showToast(title, msg) {
            const t = document.getElementById('toast');
            const tt = document.getElementById('toastTitle');
            const tm = document.getElementById('toastMessage');
            if (!t || !tt || !tm) return;
            tt.innerText = title;
            tm.innerText = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 4000);
        }

        function updateGoal() {
            state.dailyGoal = parseInt(document.getElementById('goalInput').value);
            updateUI();
            saveState();
            renderHistory();
        }

        function resetApp() {
            if (confirm("Reset everything? Your arctic history will be lost.")) {
                localStorage.removeItem('hydrobuddy_frost_state');
                location.reload();
            }
        }

        // Initialize on load
        window.addEventListener('load', loadState);
    </script>
</body>

</html>
